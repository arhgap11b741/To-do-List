#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸ” Pre-commit ì²´í¬ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤..."

# 1. ESLint ì²´í¬
echo "ğŸ“ ESLint ì²´í¬ ì¤‘..."
npm run lint
if [ $? -ne 0 ]; then
    echo "âŒ ESLint ì˜¤ë¥˜ê°€ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤. ì»¤ë°‹ì´ ì·¨ì†Œë©ë‹ˆë‹¤."
    exit 1
fi
echo "âœ… ESLint ì²´í¬ í†µê³¼"

# 2. Prettier í¬ë§· ì²´í¬
echo "ğŸ¨ Prettier í¬ë§· ì²´í¬ ì¤‘..."
npm run format:check
if [ $? -ne 0 ]; then
    echo "âŒ ì½”ë“œ í¬ë§·ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. 'npm run format'ì„ ì‹¤í–‰í•˜ì—¬ í¬ë§·ì„ ìˆ˜ì •í•˜ì„¸ìš”."
    exit 1
fi
echo "âœ… Prettier í¬ë§· ì²´í¬ í†µê³¼"

# 3. TypeScript íƒ€ì… ì²´í¬
echo "ğŸ”§ TypeScript íƒ€ì… ì²´í¬ ì¤‘..."
npm run type-check
if [ $? -ne 0 ]; then
    echo "âŒ TypeScript íƒ€ì… ì˜¤ë¥˜ê°€ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤. ì»¤ë°‹ì´ ì·¨ì†Œë©ë‹ˆë‹¤."
    exit 1
fi
echo "âœ… TypeScript íƒ€ì… ì²´í¬ í†µê³¼"

# 4. Next.js ë¹Œë“œ ì²´í¬
echo "ğŸ—ï¸  Next.js ë¹Œë“œ ì²´í¬ ì¤‘..."
npm run build
if [ $? -ne 0 ]; then
    echo "âŒ ë¹Œë“œ ì˜¤ë¥˜ê°€ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤. ì»¤ë°‹ì´ ì·¨ì†Œë©ë‹ˆë‹¤."
    exit 1
fi
echo "âœ… Next.js ë¹Œë“œ ì²´í¬ í†µê³¼"

echo "ğŸ‰ ëª¨ë“  ì²´í¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ì»¤ë°‹ì„ ì§„í–‰í•©ë‹ˆë‹¤."
